{"ast":null,"code":"/** These methods may break the react binding if called directly */\nconst skipMethods = ['setMaxBounds', 'setMinZoom', 'setMaxZoom', 'setMinPitch', 'setMaxPitch', 'setRenderWorldCopies', 'setProjection', 'setStyle', 'addSource', 'removeSource', 'addLayer', 'removeLayer', 'setLayerZoomRange', 'setFilter', 'setPaintProperty', 'setLayoutProperty', 'setLight', 'setTerrain', 'setFog', 'remove'];\nexport default function createRef(mapInstance, mapLib) {\n  if (!mapInstance) {\n    return null;\n  }\n\n  const map = mapInstance.map;\n  const result = {\n    getMap: () => map,\n    // Overwrite getters to use our shadow transform\n    getCenter: () => mapInstance.transform.center,\n    getZoom: () => mapInstance.transform.zoom,\n    getBearing: () => mapInstance.transform.bearing,\n    getPitch: () => mapInstance.transform.pitch,\n    getPadding: () => mapInstance.transform.padding,\n    getBounds: () => mapInstance.transform.getBounds(),\n    project: lnglat => {\n      return mapInstance.transform.locationPoint(mapLib.LngLat.convert(lnglat));\n    },\n    unproject: point => {\n      return mapInstance.transform.pointLocation(mapLib.Point.convert(point));\n    },\n    queryTerrainElevation: (lnglat, options) => {\n      // @ts-ignore transform not defined\n      const tr = map.transform; // @ts-ignore transform not defined\n\n      map.transform = mapInstance.transform;\n      const result = map.queryTerrainElevation(lnglat, options); // @ts-ignore transform not defined\n\n      map.transform = tr;\n      return result;\n    }\n  };\n\n  for (const key of getMethodNames(map)) {\n    // @ts-expect-error\n    if (!(key in result) && !skipMethods.includes(key)) {\n      result[key] = map[key].bind(map);\n    }\n  }\n\n  return result;\n}\n\nfunction getMethodNames(obj) {\n  const result = new Set();\n  let proto = obj;\n\n  while (proto) {\n    for (const key of Object.getOwnPropertyNames(proto)) {\n      if (key[0] !== '_' && typeof obj[key] === 'function' && key !== 'fire' && key !== 'setEventedParent') {\n        result.add(key);\n      }\n    }\n\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return Array.from(result);\n}","map":{"version":3,"sources":["../../../src/mapbox/create-ref.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/** These methods may break the react binding if called directly */\nconst skipMethods = [\n    'setMaxBounds',\n    'setMinZoom',\n    'setMaxZoom',\n    'setMinPitch',\n    'setMaxPitch',\n    'setRenderWorldCopies',\n    'setProjection',\n    'setStyle',\n    'addSource',\n    'removeSource',\n    'addLayer',\n    'removeLayer',\n    'setLayerZoomRange',\n    'setFilter',\n    'setPaintProperty',\n    'setLayoutProperty',\n    'setLight',\n    'setTerrain',\n    'setFog',\n    'remove'\n];\nexport default function createRef(mapInstance, mapLib) {\n    if (!mapInstance) {\n        return null;\n    }\n    const map = mapInstance.map;\n    const result = {\n        getMap: () => map,\n        // Overwrite getters to use our shadow transform\n        getCenter: () => mapInstance.transform.center,\n        getZoom: () => mapInstance.transform.zoom,\n        getBearing: () => mapInstance.transform.bearing,\n        getPitch: () => mapInstance.transform.pitch,\n        getPadding: () => mapInstance.transform.padding,\n        getBounds: () => mapInstance.transform.getBounds(),\n        project: (lnglat) => {\n            return mapInstance.transform.locationPoint(mapLib.LngLat.convert(lnglat));\n        },\n        unproject: (point) => {\n            return mapInstance.transform.pointLocation(mapLib.Point.convert(point));\n        },\n        queryTerrainElevation: (lnglat, options) => {\n            // @ts-ignore transform not defined\n            const tr = map.transform;\n            // @ts-ignore transform not defined\n            map.transform = mapInstance.transform;\n            const result = map.queryTerrainElevation(lnglat, options);\n            // @ts-ignore transform not defined\n            map.transform = tr;\n            return result;\n        }\n    };\n    for (const key of getMethodNames(map)) {\n        // @ts-expect-error\n        if (!(key in result) && !skipMethods.includes(key)) {\n            result[key] = map[key].bind(map);\n        }\n    }\n    return result;\n}\nfunction getMethodNames(obj) {\n    const result = new Set();\n    let proto = obj;\n    while (proto) {\n        for (const key of Object.getOwnPropertyNames(proto)) {\n            if (key[0] !== '_' &&\n                typeof obj[key] === 'function' &&\n                key !== 'fire' &&\n                key !== 'setEventedParent') {\n                result.add(key);\n            }\n        }\n        proto = Object.getPrototypeOf(proto);\n    }\n    return Array.from(result);\n}\n//# sourceMappingURL=create-ref.js.map"]},"metadata":{},"sourceType":"module"}